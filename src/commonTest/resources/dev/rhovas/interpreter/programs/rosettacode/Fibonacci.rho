func fibonacci(n: Integer): Integer {
    func positiveFibonacci(n: Integer): Integer {
        require n >= 0;
        var previous = 1;
        var current = 0;
        range(1, n, :incl).for {
            val next = current + previous;
            previous = current;
            current = next;
        };
        return current;
    }

    match {
        n >= 0: return positiveFibonacci(n);
        n.mod(2) == 0: return -positiveFibonacci(-n);
        else: return positiveFibonacci(-n);
    }
}

assert fibonacci(0) == 0;
assert fibonacci(1) == 1;
assert fibonacci(5) == 5;
assert fibonacci(20) == 6765;
assert fibonacci(-5) == 5;
assert fibonacci(-20) == -6765;
